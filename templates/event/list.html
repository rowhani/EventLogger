{% extends 'base.html' %}

{% block head %}
	<link rel="stylesheet" href="{{ STATIC_URL }}libs/bootstrap-datatables/css/dataTables.bootstrap.css">	
{% endblock %}

{% block title %}رویداد ها{% endblock %}

{% block header %}رویداد ها{% endblock %}

{% block content %}
    <a class="btn btn-primary pull-right" href="{% url 'add_event' %}" style="margin-bottom: 5px"><span class="glyphicon glyphicon-plus"></span> ایجاد رویداد</a>
	<table id="events" class="table table-striped table-condensed  table-bordered pull-left" cellspacing="0" width="100%">
        <thead>
            <tr>
				<th style="width: 15%!important"></th>
                <th style="width: 25%">موضوع</th>
                <th style="width: 15%">تاریخ وقوع</th>
                <th style="width: 15%">مکان وقوع</th>
				<th style="width: 25%">اشخاص مرتبط</th>
				<th style="width: 5%">عملیات</th>
            </tr>
        </thead>
		<tbody>
			{%for event in events %}
				<tr>
					<td style="vertical-align: middle">
						<div class="col-lg-12">
							<a href="{% url 'detail_event' event.id %}">
								<span class="thumbnail" style="margin-bottom: 0">
									{% if event.photo %}
										<img src="{{ STATIC_URL }}external-assets/event-images/{{ event.photo }}"/>
									{% else %}
										<img src="{{ STATIC_URL }}images/unknown.png"/>
									{% endif %}
								</span>
							</a>
						</div>
					</td>
					<td>
						<a href="{% url 'detail_event' event.id %}">{{ event.subject }}</a>
						{% if event.date_ended %}
							<span class="label label-success">پایان یافته</span>
						{% endif %}
					</td>
					<td class="convert-date">
						{{ event.date_happened }}
					</td>
					<td>
						{{ event.location }}
					</td>
					<td>
						{% for person in event.persons.all %}
							<a href="/person/{{ person.id }}">{{ person }}</a>{% if not forloop.last %},{% endif %} 
						{% endfor %}
					</td>
					<td>
						<a class="btn btn-success btn-xs" title="ویرایش">
							<span class="glyphicon glyphicon-edit"></span>
						</a>
						<a class="btn btn-danger btn-xs" title="حذف">
							<span class="glyphicon glyphicon-trash"></span>
						</a>
					</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
{% endblock %}

{% block scripts %}
	<script src="{{ STATIC_URL }}libs/bootstrap-datatables/js/jquery.dataTables.min.js"></script>	
	<script src="{{ STATIC_URL }}libs/bootstrap-datatables/js/dataTables.bootstrap.js"></script>	
	<script>
		$(document).ready(function() {
			$('#events').dataTable({
				"sDom": '<"top"f>rt<"bottom"p><"clear">',
				"oLanguage": {
					"oPaginate": {
						"sNext": "بعدی",
						"sFirst": "اول",
						"sPrevious": "قبلی",
						"sLast": "آخر"
					}
				}
			});			
			$('.dataTables_filter label').contents().filter(function() { return this.nodeType == 3 }).replaceWith('جستجوی سریع: ');
		});
	</script>
{% endblock %}